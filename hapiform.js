var Core=function(){function t(t){var e,n;this.input_error_class_name="hapi-form-input-error",this.thankPageUrl=null!==(e=t.redirectUrl)&&void 0!==e?e:"/thank-you.html",this._formElement=document.querySelector(null!==(n=t.formSelector)&&void 0!==n?n:"#hapi-form"),this.i18nLocale=t.i18nLocale,this.apiEndpoint=this.getApiEndPoint(t.hapiFormID),this.backendEndpoint="https://hapiform.sg/".concat(t.hapiFormID),this.thankPageUrl=window.location.origin+t.redirectUrl}return t.prototype.getApiEndPoint=function(t){var e="https://hapiform.sg/api/".concat(t),n=new URL(e);return"localhost"!=window.location.hostname&&"127.0.0.1"!=window.location.hostname||n.searchParams.set("test",String(1)),this.i18nLocale&&n.searchParams.set("locale",this.i18nLocale),n.href},t.prototype.resetInputs=function(){this._formElement.reset()},t.prototype.disableSubmitButtons=function(){this._formElement.querySelectorAll("[type=submit]").forEach((function(t){t.setAttribute("disabled",String(!0))}))},t.prototype.enableSubmitButtons=function(){this._formElement.querySelectorAll("[type=submit]").forEach((function(t){t.removeAttribute("disabled")}))},t.prototype.handleSubmission=function(){var t=this;this._formElement.addEventListener("submit",(function(e){e.preventDefault(),t.disableSubmitButtons(),t.removeError();var n=e.currentTarget,o=new FormData(n),r=new URL(window.location.href);o.append("x_origin",r.origin+r.pathname);var i={};o.forEach((function(t,e){return i[e]=t}));var a=JSON.stringify(i);fetch(t.apiEndpoint,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:a}).then((function(t){return{data:t.json(),status:t.status}})).then((function(e){var n=e.status;201===n?(t.resetInputs(),t.redirectToThankYouPage()):422===n?e.data.then((function(e){e.errors&&t.showError(e.errors)})):console.error("statusCode: ",n,"Response: ",e),t.enableSubmitButtons()})).catch((function(e){console.error(e),t.enableSubmitButtons()}))}))},t.prototype.removeError=function(){this._formElement.querySelectorAll("."+this.input_error_class_name).forEach((function(t){t.parentElement.removeChild(t)}))},t.prototype.showError=function(t){var e=this;Object.keys(t).forEach((function(n){var o=document.createElement("div");o.setAttribute("class",e.input_error_class_name),o.innerText=t[n][0],o.setAttribute("style","color:red"),e._formElement.querySelector('[name="'.concat(n,'"]')).parentElement.appendChild(o)}))},t.prototype.redirectToThankYouPage=function(){window.location.href=this.thankPageUrl},t}(),HapiForm=function(){function t(t){var e=this;this.hapi=new Core(t),window.addEventListener("load",(function(){e.displayEndpoints(),e.onSubmission()}))}return t.prototype.displayEndpoints=function(){console.info("ðŸš€ hapi form ",this.hapi.thankPageUrl),console.info("ðŸš€ hapi form ",this.hapi.backendEndpoint)},t.prototype.onSubmission=function(){this.hapi.handleSubmission()},t}();