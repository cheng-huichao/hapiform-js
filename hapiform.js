var Core=function(){function t(t){var e,o,n;this.input_error_class_name="hapi-form-input-error",this.thankPageUrl=null!==(e=t.redirectUrl)&&void 0!==e?e:"/thank-you.html",this._formElement=document.querySelector(null!==(o=t.formSelector)&&void 0!==o?o:"#hapi-form"),console.log(null!==(n=t.formSelector)&&void 0!==n?n:"#hapi-form"),console.log(this._formElement),this.i18nLocale=t.i18nLocale,this.apiEndpoint=this.getApiEndPoint(t.hapiFormID),this.backendEndpoint="https://hapiform.sg/".concat(t.hapiFormID),this.thankPageUrl=window.location.origin+t.redirectUrl}return t.prototype.getApiEndPoint=function(t){var e="https://hapiform.sg/api/".concat(t),o=new URL(e);return"localhost"!=window.location.hostname&&"127.0.0.1"!=window.location.hostname||o.searchParams.set("test",String(1)),this.i18nLocale&&o.searchParams.set("locale",this.i18nLocale),o.href},t.prototype.resetInputs=function(){this._formElement.reset()},t.prototype.disableSubmitButtons=function(){this._formElement.querySelectorAll("[type=submit]").forEach((function(t){t.setAttribute("disabled",String(!0))}))},t.prototype.enableSubmitButtons=function(){this._formElement.querySelectorAll("[type=submit]").forEach((function(t){t.removeAttribute("disabled")}))},t.prototype.handleSubmission=function(){var t=this;this._formElement.addEventListener("submit",(function(e){e.preventDefault(),t.disableSubmitButtons(),t.removeError();var o=e.currentTarget,n=new FormData(o),r=new URL(window.location.href);n.append("x_origin",r.origin+r.pathname);var i={};n.forEach((function(t,e){return i[e]=t}));var a=JSON.stringify(i);fetch(t.apiEndpoint,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:a}).then((function(t){return{data:t.json(),status:t.status}})).then((function(e){var o=e.status;201===o?(t.resetInputs(),t.redirectToThankYouPage()):422===o?e.data.then((function(e){e.errors&&t.showError(e.errors)})):console.error("statusCode: ",o,"Response: ",e),t.enableSubmitButtons()})).catch((function(e){console.log(e),t.enableSubmitButtons()}))}))},t.prototype.removeError=function(){this._formElement.querySelectorAll("."+this.input_error_class_name).forEach((function(t){t.parentElement.removeChild(t)}))},t.prototype.showError=function(t){var e=this;Object.keys(t).forEach((function(o){var n=document.createElement("div");n.setAttribute("class",e.input_error_class_name),n.innerText=t[o][0],n.setAttribute("style","color:red"),e._formElement.querySelector('[name="'.concat(o,'"]')).parentElement.appendChild(n)}))},t.prototype.redirectToThankYouPage=function(){window.location.href=this.thankPageUrl},t}(),HapiForm=function(){function t(t){var e=this;this.hapi=new Core(t),window.addEventListener("load",(function(){e.displayEndpoints(),e.onSubmission()}))}return t.prototype.displayEndpoints=function(){console.log("ðŸš€ ",this.hapi.thankPageUrl),console.log("ðŸš€ ",this.hapi.backendEndpoint)},t.prototype.onSubmission=function(){this.hapi.handleSubmission()},t}();