var Core=function(){function t(t){var e,r;this.input_error_class_name="hapi-form-input-error",this.default_form_selector="#hapi-form",this.thankPageUrl=null!==(e=t.redirectUrl)&&void 0!==e?e:"/thank-you.html",this._formElement=document.querySelector(null!==(r=t.formSelector)&&void 0!==r?r:this.default_form_selector),this.i18nLocale=t.i18nLocale,this.apiEndpoint=this.getApiEndPoint(t.hapiFormID),this.backendEndpoint="https://hapiform.sg/".concat(t.hapiFormID),this.thankPageUrl=window.location.origin+t.redirectUrl}return t.prototype.getApiEndPoint=function(t){var e="https://hapiform.sg/api/".concat(t),r=new URL(e);return"localhost"!=window.location.hostname&&"127.0.0.1"!=window.location.hostname||r.searchParams.set("test",String(1)),this.i18nLocale&&r.searchParams.set("locale",this.i18nLocale),r.href},t.prototype.resetInputs=function(){this._formElement.reset()},t.prototype.disableSubmitButtons=function(){this._formElement.querySelectorAll("[type=submit]").forEach((function(t){t.setAttribute("disabled",String(!0))}))},t.prototype.enableSubmitButtons=function(){this._formElement.querySelectorAll("[type=submit]").forEach((function(t){t.removeAttribute("disabled")}))},t.prototype.handleSubmission=function(){var t=this;this._formElement.addEventListener("submit",(function(e){e.preventDefault(),t.disableSubmitButtons(),t.removeError();var r=e.currentTarget,o=new FormData(r),n=new URL(window.location.href);o.append("x_origin",n.origin+n.pathname);var i={};o.forEach((function(t,e){return i[e]=t}));var a=JSON.stringify(i);fetch(t.apiEndpoint,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:a}).then((function(t){return{data:t.json(),status:t.status}})).then((function(e){var r=e.status;201===r?(t.resetInputs(),t.redirectToThankYouPage()):422===r?e.data.then((function(e){e.errors&&t.showError(e.errors)})):console.error("statusCode: ",r,"Response: ",e),t.enableSubmitButtons()})).catch((function(e){console.error(e),t.enableSubmitButtons()}))}))},t.prototype.removeError=function(){this._formElement.querySelectorAll("."+this.input_error_class_name).forEach((function(t){t.parentElement.removeChild(t)}))},t.prototype.showError=function(t){var e=this;Object.keys(t).forEach((function(r){var o=document.createElement("div");o.setAttribute("class",e.input_error_class_name),o.innerText=t[r][0],o.setAttribute("style","color:red"),e._formElement.querySelector('[name="'.concat(r,'"]')).parentElement.appendChild(o)}))},t.prototype.redirectToThankYouPage=function(){window.location.href=this.thankPageUrl},t}(),HapiForm=function(){function t(t){var e;if(this.isValidParams=!1,this.handleParamCheck(t),this.isValidParams){var r=function(r){var o=new Core(t[r]),n=null!==(e=t[r].formSelector)&&void 0!==e?e:o.default_form_selector;if(null===document.querySelector(n))return console.error("can't find the form by selector",n),"break";window.addEventListener("load",(function(){console.info("ðŸš€ hapi form ",o.thankPageUrl),console.info("ðŸš€ hapi form ",o.backendEndpoint),o.handleSubmission()}))};for(var o in t){if("break"===r(o))break}}}return t.prototype.handleParamCheck=function(t){if(Array.isArray(t))if(0!==t.length){var e=[];for(var r in t)null!=t[r].hapiFormID&&t[r].hapiFormID.trim().length>0||(console.error("No HapiFormID provided"),e.push(1));e.length>0||(this.isValidParams=!0)}else console.error("empty parameters of HapiForm constructor");else console.error("invalid parameters of HapiForm constructor")},t}();